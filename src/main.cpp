#include <cstdlib>

#include <ros/ros.h>

#include <droneoa_ros/CNCInterface.hpp>
#include <droneoa_ros/PDN.hpp>

int main(int argc, char **argv) {
    // Setup Refresh Rate
    int rate = 10;

    ros::init(argc, argv, "mavros_takeoff");
    ros::NodeHandle n;

    ros::Rate r(rate);

    // Interface Instance
    CNCInterface cnc;
    cnc.init(n);

    ////////////////////////////////////////////
    /////////////  GUIDED MODE  ////////////////
    ////////////////////////////////////////////
    cnc.setMode(FLT_MODE_GUIDED);

    ////////////////////////////////////////////
    /////////////////  ARM  ////////////////////
    ////////////////////////////////////////////
    cnc.armVehicle();

    ////////////////////////////////////////////
    ///////////////  TAKEOFF  //////////////////
    ////////////////////////////////////////////
    cnc.takeoff(10);

    ////////////////////////////////////////////
    ///////////////  DO STUFF  /////////////////
    ////////////////////////////////////////////
    sleep(10);

    ////////////////////////////////////////////
    /////////////////  LAND  ///////////////////
    ////////////////////////////////////////////
    cnc.land(10);

    while (n.ok())
    {
      ros::spinOnce();
      r.sleep();
    }

    return 0;
}